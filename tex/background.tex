% !TEX root = ../thesis.tex

\chapter{背景和动机}
在这一章，我们会对深度学习背景下视频流处理的实际应用需求以及问题做总结。在此基础上，我们会列出对AVPipe设计的期望与目标。
\section{视频流处理的应用需求}\label{ch3:req}
随着人工智能的发展，不论在生产实践中还是在生活娱乐中，我们都期望人工智能技术能够给现有的应用带来创新。计算机视觉是应用人工智能最主要的领域之一，这之中对视频流的智能分析与推理可以说是许多智能视觉算法的主要现实应用形式。在生产实践中，无人驾驶、智能机器人等技术对智能视频流的推理分析有着直接的技术依赖，智能工厂、智慧城市的建设也需要利用视频的视觉分析来提高管理效率，来实现自动化管理。在生活娱乐中，智能视频处理可以为用户内容创作提供便捷，近年来在智能手机上兴起的视频增强、现实增强功能，如iPhone的Animoji\footnote{\url{https://support.apple.com/en-us/HT208190}}功能，需要智能视频处理及时的支持；
视频内容创作分享平台如抖音\footnote{\url{https://www.tiktok.com/}}、哔哩哔哩\footnote{\url{https://www.bilibili.com/}}等都提供了诸如智能抠图（图像分割），人物识别等功能；高效，准确的视频处理也可以被应用在游戏创作中，为玩家带来玩法上的创新。\par

\section{视频流处理的现存问题}\label{ch3:problems}
针对\ref{ch3:req}中提到的关于视频流处理的应用需求，我们也通过相关产品的实际使用以及一般视频流处理应用的开发实践，总结得出了现在视频流处理的应用与开发中存在的一些问题：\par
% \begin{enumerate}
% \item
\textbf{开发与部署难度大。}深度学习相关视频流处理应用的开发流程一般都是先利用Python环境下的各类机器学习框架（如TensorFlow， PyTorch等）对处理算法做验证与测试，然后再将处理打包或利用其他语言重写。考虑到计算的高效性、代码的安全性以及部署的通用性，一般会将验证通过的视觉处理算法用C/C++语言进行重写。C/C++语言中并没有类似Python中NumPy\cite{oliphant2006guide}的通用科学计算库可以无缝应用在处理流程的各个步骤中，开发人员需要手动完成数据类型以及数据布局在不同计算库之间的转换，这一问题在处理神经网络所涉及的高维张量数据时表现得尤为明显。此外，不同计算库采用的截然不同的代码规范以及调用接口也进一步提高了C/C++语言下视频流处理应用的开发难度。\par
% \item 
\textbf{缺乏针对性优化。}有关视频流处理的优化在本文\ref{intro_opt}中有进行介绍。完善与成熟的相关算法框架的一般都会提供一些示例程序供用户进行学习或使用，如OpenCV中有关DNN的示例\footnote{\url{https://github.com/opencv/opencv/tree/master/samples/dnn}}，TensorFlow中有关移动部署的示例\footnote{\url{https://www.tensorflow.org/lite/models/}}。我们尝试在个人设备%\footnote{Intel i5-8210Y处理器的MacBook Air笔记本和Qualcomm 835处理器的Sony XZ1智能手机}
上编译运行OpenCV的目标检测示例以及TensorFlow的人体姿态估计示例，这两者的实际表现并不出色。实际处理帧率远低于可以流畅实时处理的期望。
观察开源代码可知，OpenCV的示例虽提供了简单多线程的运行优化，但其并没有在深度神经网络的推理上提供充分的加速优化；TensorFlow的姿态估计示例则没有在代码中提供充分的非神经网络推理部分的优化，整个处理过程都在单线中进行。与其他将数据传回云端进行处理的人工智能应用（如推荐系统和语音识别）不同的是，视频流处理的数据传输量大，对实时性的要求也相对较高，一般倾向在本地完成大部分计算。这也侧面说明了对视频流处理进行优化的必要性。
% \item 
% \end{enumerate}

\section{研究动机与目标}\label{moti_obj}
以上介绍的基于深度学习的视频流处理应用中所存在的需求与问题促使了我们开展有关视频流处理优化的研究。我们期望提供一种编程模型或框架在解决以上提及问题的同时，满足实际生产的需求。具体来说，我们所提出的框架需要实现以下目标：
\begin{enumerate}
    \item 较完整的视频流处理开发框架，支持视频流处理每一步骤在框架内的实现；
    \item 较为丰富的平台与硬件支持（如主流桌面与移动系统下的多种CPU，GPU）；
    \item 提供能够轻松上手的简单直接的开发流程；
    \item 对主流神经网络推理引擎提供统一的支持与封装；
    \item 提供自动化工具对处理流程图进行代码生成生成与运行优化；
    \item 提供性能分析以及可视化展示工具来指导对处理流程的优化。
\end{enumerate}\par~\par
为尽可能地实现以上目标，我们提出并实现了Accel-Video Pipe\footnote{\url{https://github.com/nexuslrf/Accel-Video-Pipe}}这一针对深度学习视频流处理的C++编程框架。我们期望AVPipe的框架能够满足实际视频流处理任务的开发需求。

\section{本章小结}
本章针对实际视频流处理应用中存在的需求与问题做了简单的介绍，分析了视频流处理在生产实践与生活娱乐中的应用前景，也指出了现有应用在开发部署以及运行优化上存在的不足之处。
这些需求与不足也直接引出了本文的研究动机与研究目标——构建一个更为友好，更为高效的C++编程框架AVPipe。在接下来的章节中，我们会对AVPipe的设计与实践做更详细的介绍。